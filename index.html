<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîç MURDLE Logic Grid v2.0</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üîç</text></svg>">
    <meta name="description" content="Resolva puzzles de l√≥gica estilo MURDLE com grades interativas personaliz√°veis - Formato convencional e separado">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // √çcones SVG inline para n√£o depender de biblioteca externa
        const Icons = {
            Plus: () => (
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <path d="M12 5v14M5 12h14"/>
                </svg>
            ),
            X: () => (
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <path d="M18 6 6 18M6 6l12 12"/>
                </svg>
            ),
            Download: () => (
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/>
                </svg>
            ),
            Upload: () => (
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"/>
                </svg>
            ),
            RotateCcw: () => (
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <path d="M1 4v6h6M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/>
                </svg>
            ),
            Sun: () => (
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <circle cx="12" cy="12" r="5"/>
                    <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
                </svg>
            ),
            Moon: () => (
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                </svg>
            ),
            Settings: () => (
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <circle cx="12" cy="12" r="3"/>
                    <path d="M12 1v6M12 17v6M3.05 9.95l4.24 4.24M16.71 7.29l4.24 4.24M1 12h6M17 12h6M3.05 14.05l4.24-4.24M16.71 16.71l4.24-4.24"/>
                </svg>
            )
        };

        const MurdleApp = () => {
            const [categories, setCategories] = useState([
                { name: 'Suspeitos', items: ['üë®‚Äçüíº', 'üë©‚Äç‚öïÔ∏è', 'üë®‚Äçüç≥'] },
                { name: 'Armas', items: ['üî™', 'üíä', 'üî´'] },
                { name: 'Locais', items: ['üè†', 'üè¢', 'üå≥'] }
            ]);
            
            const [grid, setGrid] = useState({});
            const [darkMode, setDarkMode] = useState(false);
            const [showSettings, setShowSettings] = useState(false);
            const [gridFormat, setGridFormat] = useState('conventional'); // 'conventional' ou 'separated'

            // Estados para c√©lulas (0: vazio, 1: X, 2: ‚úì)
            const CELL_STATES = ['', 'X', '‚úì'];
            const CELL_COLORS = ['', 'text-red-500 bg-red-50', 'text-green-500 bg-green-50'];
            const CELL_COLORS_DARK = ['', 'text-red-400 bg-red-900/30', 'text-green-400 bg-green-900/30'];

            // Carregamento e salvamento autom√°tico
            useEffect(() => {
                const savedData = localStorage.getItem('murdle-data');
                const savedTheme = localStorage.getItem('murdle-theme');
                
                if (savedData) {
                    try {
                        const data = JSON.parse(savedData);
                        if (data.categories) setCategories(data.categories);
                        if (data.grid) setGrid(data.grid);
                        if (data.gridFormat) setGridFormat(data.gridFormat);
                    } catch (e) {
                        console.error('Erro ao carregar dados:', e);
                    }
                }
                
                if (savedTheme) {
                    setDarkMode(savedTheme === 'dark');
                }
            }, []);

            useEffect(() => {
                const dataToSave = { categories, grid, gridFormat };
                localStorage.setItem('murdle-data', JSON.stringify(dataToSave));
            }, [categories, grid, gridFormat]);

            useEffect(() => {
                localStorage.setItem('murdle-theme', darkMode ? 'dark' : 'light');
            }, [darkMode]);

            // Fun√ß√µes principais
            const getCellKey = (catIndex1, itemIndex1, catIndex2, itemIndex2) => {
                return `${catIndex1}-${itemIndex1}-${catIndex2}-${itemIndex2}`;
            };

            const toggleCell = (catIndex1, itemIndex1, catIndex2, itemIndex2) => {
                const key = getCellKey(catIndex1, itemIndex1, catIndex2, itemIndex2);
                const currentState = grid[key] || 0;
                const newState = (currentState + 1) % 3;
                
                setGrid(prev => ({
                    ...prev,
                    [key]: newState
                }));
            };

            const getCellState = (catIndex1, itemIndex1, catIndex2, itemIndex2) => {
                const key = getCellKey(catIndex1, itemIndex1, catIndex2, itemIndex2);
                return grid[key] || 0;
            };

            const addItem = (categoryIndex) => {
                const newItem = prompt('Digite o novo item (texto, abrevia√ß√£o ou emoji):');
                if (newItem && newItem.trim()) {
                    setCategories(prev => prev.map((cat, idx) => 
                        idx === categoryIndex 
                            ? { ...cat, items: [...cat.items, newItem.trim()] }
                            : cat
                    ));
                }
            };

            const editItem = (categoryIndex, itemIndex) => {
                const currentItem = categories[categoryIndex].items[itemIndex];
                const newItem = prompt('Editar item (texto, abrevia√ß√£o ou emoji):', currentItem);
                if (newItem !== null && newItem.trim()) {
                    setCategories(prev => prev.map((cat, idx) => 
                        idx === categoryIndex 
                            ? { 
                                ...cat, 
                                items: cat.items.map((item, i) => 
                                    i === itemIndex ? newItem.trim() : item
                                )
                            }
                            : cat
                    ));
                }
            };

            const removeItem = (categoryIndex, itemIndex) => {
                if (categories[categoryIndex].items.length <= 2) {
                    alert('Cada categoria deve ter pelo menos 2 itens!');
                    return;
                }
                
                setCategories(prev => prev.map((cat, idx) => 
                    idx === categoryIndex 
                        ? { ...cat, items: cat.items.filter((_, i) => i !== itemIndex) }
                        : cat
                ));
            };

            const editCategoryName = (categoryIndex) => {
                const newName = prompt('Nome da categoria:', categories[categoryIndex].name);
                if (newName && newName.trim()) {
                    setCategories(prev => prev.map((cat, idx) => 
                        idx === categoryIndex 
                            ? { ...cat, name: newName.trim() }
                            : cat
                    ));
                }
            };

            const clearGrid = () => {
                if (confirm('Deseja limpar toda a grade?')) {
                    setGrid({});
                }
            };

            const exportData = () => {
                const data = { categories, grid, gridFormat };
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'murdle-puzzle.json';
                a.click();
                URL.revokeObjectURL(url);
            };

            const importData = (event) => {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const data = JSON.parse(e.target.result);
                            if (data.categories) setCategories(data.categories);
                            if (data.grid) setGrid(data.grid);
                            if (data.gridFormat) setGridFormat(data.gridFormat);
                            alert('Dados importados com sucesso!');
                        } catch (error) {
                            alert('Erro ao importar dados!');
                        }
                    };
                    reader.readAsText(file);
                }
                event.target.value = '';
            };

            // Renderizar grade convencional (formato livro MURDLE)
            const renderConventionalGrid = () => {
                if (categories.length < 3) {
                    return (
                        <div className={`text-center py-8 ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                            A grade convencional requer pelo menos 3 categorias
                        </div>
                    );
                }

                const [suspeitos, armas, locais] = categories;
                
                return (
                    <div className="overflow-auto no-scrollbar">
                        <div className="inline-block">
                            {/* Grade √∫nica integrada */}
                            <table className="border-collapse">
                                <thead>
                                    <tr>
                                        <th className="w-16 h-12"></th>
                                        {/* Headers: SUSPEITOS */}
                                        {suspeitos.items.map((item, idx) => (
                                            <th key={`suspeitos-${idx}`} className={`w-16 h-12 text-center text-sm border ${
                                                darkMode ? 'border-gray-600 bg-gray-700 text-gray-300' : 'border-gray-300 bg-gray-50'
                                            }`}>
                                                <div className="px-1 break-words">{item}</div>
                                            </th>
                                        ))}
                                        {/* Headers: LOCAIS */}
                                        {locais.items.map((item, idx) => (
                                            <th key={`locais-${idx}`} className={`w-16 h-12 text-center text-sm border ${
                                                darkMode ? 'border-gray-600 bg-gray-700 text-gray-300' : 'border-gray-300 bg-gray-50'
                                            }`}>
                                                <div className="px-1 break-words">{item}</div>
                                            </th>
                                        ))}
                                    </tr>
                                </thead>
                                <tbody>
                                    {/* Linhas: ARMAS */}
                                    {armas.items.map((armaItem, armaIdx) => (
                                        <tr key={`arma-${armaIdx}`}>
                                            <td className={`w-16 h-12 text-center text-sm border font-medium ${
                                                darkMode ? 'border-gray-600 bg-gray-700 text-gray-300' : 'border-gray-300 bg-gray-50'
                                            }`}>
                                                <div className="px-1 break-words">{armaItem}</div>
                                            </td>
                                            
                                            {/* C√©lulas: ARMAS √ó SUSPEITOS (interativas) */}
                                            {suspeitos.items.map((suspeitoItem, suspeitoIdx) => {
                                                const state = getCellState(1, armaIdx, 0, suspeitoIdx);
                                                return (
                                                    <td 
                                                        key={`arma-suspeito-${suspeitoIdx}`}
                                                        className={`w-16 h-12 text-center border cursor-pointer select-none font-bold text-lg transition-colors ${
                                                            darkMode 
                                                                ? `border-gray-600 hover:bg-gray-600 ${CELL_COLORS_DARK[state]}` 
                                                                : `border-gray-300 hover:bg-gray-100 ${CELL_COLORS[state]}`
                                                        }`}
                                                        onClick={() => toggleCell(1, armaIdx, 0, suspeitoIdx)}
                                                    >
                                                        {CELL_STATES[state]}
                                                    </td>
                                                );
                                            })}
                                            
                                            {/* C√©lulas: ARMAS √ó LOCAIS (interativas) */}
                                            {locais.items.map((localItem, localIdx) => {
                                                const state = getCellState(1, armaIdx, 2, localIdx);
                                                return (
                                                    <td 
                                                        key={`arma-local-${localIdx}`}
                                                        className={`w-16 h-12 text-center border cursor-pointer select-none font-bold text-lg transition-colors ${
                                                            darkMode 
                                                                ? `border-gray-600 hover:bg-gray-600 ${CELL_COLORS_DARK[state]}` 
                                                                : `border-gray-300 hover:bg-gray-100 ${CELL_COLORS[state]}`
                                                        }`}
                                                        onClick={() => toggleCell(1, armaIdx, 2, localIdx)}
                                                    >
                                                        {CELL_STATES[state]}
                                                    </td>
                                                );
                                            })}
                                        </tr>
                                    ))}
                                    
                                    {/* Linhas: LOCAIS */}
                                    {locais.items.map((localItem, localIdx) => (
                                        <tr key={`local-${localIdx}`}>
                                            <td className={`w-16 h-12 text-center text-sm border font-medium ${
                                                darkMode ? 'border-gray-600 bg-gray-700 text-gray-300' : 'border-gray-300 bg-gray-50'
                                            }`}>
                                                <div className="px-1 break-words">{localItem}</div>
                                            </td>
                                            
                                            {/* C√©lulas: LOCAIS √ó SUSPEITOS (interativas) */}
                                            {suspeitos.items.map((suspeitoItem, suspeitoIdx) => {
                                                const state = getCellState(2, localIdx, 0, suspeitoIdx);
                                                return (
                                                    <td 
                                                        key={`local-suspeito-${suspeitoIdx}`}
                                                        className={`w-16 h-12 text-center border cursor-pointer select-none font-bold text-lg transition-colors ${
                                                            darkMode 
                                                                ? `border-gray-600 hover:bg-gray-600 ${CELL_COLORS_DARK[state]}` 
                                                                : `border-gray-300 hover:bg-gray-100 ${CELL_COLORS[state]}`
                                                        }`}
                                                        onClick={() => toggleCell(2, localIdx, 0, suspeitoIdx)}
                                                    >
                                                        {CELL_STATES[state]}
                                                    </td>
                                                );
                                            })}
                                            
                                            {/* Se√ß√£o removida: LOCAIS √ó LOCAIS n√£o existe */}
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </div>
                );
            };

            // Renderizar grade para duas categorias (formato separado)
            const renderGrid = (cat1Index, cat2Index) => {
                const cat1 = categories[cat1Index];
                const cat2 = categories[cat2Index];

                return (
                    <div className="mb-8 overflow-auto no-scrollbar" key={`grid-${cat1Index}-${cat2Index}`}>
                        <h3 className={`font-semibold mb-4 text-center ${darkMode ? 'text-white' : 'text-gray-800'}`}>
                            {cat1.name} √ó {cat2.name}
                        </h3>
                        
                        <div className="inline-block min-w-full">
                            <table className="border-collapse mx-auto">
                                <thead>
                                    <tr>
                                        <th className="w-24 h-12"></th>
                                        {cat2.items.map((item, idx) => (
                                            <th key={idx} className={`w-16 h-12 text-center text-sm border ${
                                                darkMode ? 'border-gray-600 bg-gray-700 text-gray-300' : 'border-gray-300 bg-gray-50'
                                            }`}>
                                                <div className="px-1 break-words">{item}</div>
                                            </th>
                                        ))}
                                    </tr>
                                </thead>
                                <tbody>
                                    {cat1.items.map((item1, idx1) => (
                                        <tr key={idx1}>
                                            <td className={`w-24 h-12 text-center text-sm border font-medium ${
                                                darkMode ? 'border-gray-600 bg-gray-700 text-gray-300' : 'border-gray-300 bg-gray-50'
                                            }`}>
                                                <div className="px-1 break-words">{item1}</div>
                                            </td>
                                            {cat2.items.map((item2, idx2) => {
                                                const state = getCellState(cat1Index, idx1, cat2Index, idx2);
                                                return (
                                                    <td 
                                                        key={idx2}
                                                        className={`w-16 h-12 text-center border cursor-pointer select-none font-bold text-lg transition-colors ${
                                                            darkMode 
                                                                ? `border-gray-600 hover:bg-gray-600 ${CELL_COLORS_DARK[state]}` 
                                                                : `border-gray-300 hover:bg-gray-100 ${CELL_COLORS[state]}`
                                                        }`}
                                                        onClick={() => toggleCell(cat1Index, idx1, cat2Index, idx2)}
                                                    >
                                                        {CELL_STATES[state]}
                                                    </td>
                                                );
                                            })}
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </div>
                );
            };

            return (
                <div className={`min-h-screen transition-colors ${darkMode ? 'bg-gray-900' : 'bg-gray-50'}`}>
                    <div className="max-w-6xl mx-auto p-4">
                        {/* Header */}
                        <div className="flex items-center justify-between mb-6">
                            <h1 className={`text-2xl md:text-3xl font-bold ${darkMode ? 'text-white' : 'text-gray-800'}`}>
                                üîç MURDLE Logic Grid <span className="text-lg font-normal opacity-75">v2.0</span>
                            </h1>
                            
                            <div className="flex gap-2">
                                <button
                                    onClick={() => setDarkMode(!darkMode)}
                                    className={`p-2 rounded-lg transition-colors ${
                                        darkMode ? 'bg-gray-700 text-yellow-400 hover:bg-gray-600' : 'bg-white text-gray-600 hover:bg-gray-100'
                                    }`}
                                    title={darkMode ? 'Tema Claro' : 'Tema Escuro'}
                                >
                                    {darkMode ? <Icons.Sun /> : <Icons.Moon />}
                                </button>
                                
                                <button
                                    onClick={() => setShowSettings(!showSettings)}
                                    className={`p-2 rounded-lg transition-colors ${
                                        darkMode ? 'bg-gray-700 text-gray-300 hover:bg-gray-600' : 'bg-white text-gray-600 hover:bg-gray-100'
                                    }`}
                                    title="Configura√ß√µes"
                                >
                                    <Icons.Settings />
                                </button>
                            </div>
                        </div>

                        {/* Grid Format Selector */}
                        <div className={`mb-6 p-4 rounded-lg ${darkMode ? 'bg-gray-800 border-gray-600' : 'bg-white border-gray-200'} border`}>
                            <h3 className={`font-semibold mb-3 ${darkMode ? 'text-white' : 'text-gray-800'}`}>
                                Formato da Grade:
                            </h3>
                            <div className="flex flex-wrap gap-3">
                                <button
                                    onClick={() => setGridFormat('conventional')}
                                    className={`px-4 py-2 rounded-lg transition-colors text-sm ${
                                        gridFormat === 'conventional' 
                                            ? 'bg-blue-500 text-white' 
                                            : darkMode 
                                                ? 'bg-gray-700 text-gray-300 hover:bg-gray-600' 
                                                : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                                    }`}
                                >
                                    üìñ Convencional (Livro)
                                </button>
                                <button
                                    onClick={() => setGridFormat('separated')}
                                    className={`px-4 py-2 rounded-lg transition-colors text-sm ${
                                        gridFormat === 'separated' 
                                            ? 'bg-blue-500 text-white' 
                                            : darkMode 
                                                ? 'bg-gray-700 text-gray-300 hover:bg-gray-600' 
                                                : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                                    }`}
                                >
                                    üìã Separado (3 Se√ß√µes)
                                </button>
                            </div>
                            <p className={`text-sm mt-2 ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                {gridFormat === 'conventional' 
                                    ? 'Grade unificada como nos livros MURDLE originais' 
                                    : 'Grade dividida em se√ß√µes separadas para cada combina√ß√£o'}
                            </p>
                        </div>

                        {/* Settings Panel */}
                        {showSettings && (
                            <div className={`mb-6 p-4 rounded-lg border ${
                                darkMode ? 'bg-gray-800 border-gray-600' : 'bg-white border-gray-200'
                            }`}>
                                <div className="flex flex-wrap gap-2 mb-4">
                                    <button
                                        onClick={clearGrid}
                                        className="flex items-center gap-2 px-3 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm"
                                    >
                                        <Icons.RotateCcw />
                                        Limpar Grade
                                    </button>
                                    
                                    <button
                                        onClick={exportData}
                                        className="flex items-center gap-2 px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm"
                                    >
                                        <Icons.Download />
                                        Exportar
                                    </button>
                                    
                                    <label className="flex items-center gap-2 px-3 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors cursor-pointer text-sm">
                                        <Icons.Upload />
                                        Importar
                                        <input type="file" accept=".json" onChange={importData} className="hidden" />
                                    </label>
                                </div>

                                {/* Category Management */}
                                <div className="space-y-4">
                                    {categories.map((category, catIdx) => (
                                        <div key={catIdx} className={`p-3 rounded border ${
                                            darkMode ? 'border-gray-600 bg-gray-700' : 'border-gray-300 bg-gray-50'
                                        }`}>
                                            <div className="flex items-center justify-between mb-2">
                                                <button
                                                    onClick={() => editCategoryName(catIdx)}
                                                    className={`font-medium hover:underline text-left ${
                                                        darkMode ? 'text-white' : 'text-gray-800'
                                                    }`}
                                                    title="Clique para editar nome"
                                                >
                                                    {category.name}
                                                </button>
                                                <button
                                                    onClick={() => addItem(catIdx)}
                                                    className={`p-1 rounded transition-colors ${
                                                        darkMode ? 'text-green-400 hover:bg-gray-600' : 'text-green-600 hover:bg-gray-200'
                                                    }`}
                                                    title="Adicionar item"
                                                >
                                                    <Icons.Plus />
                                                </button>
                                            </div>
                                            
                                            <div className="flex flex-wrap gap-2">
                                                {category.items.map((item, itemIdx) => (
                                                    <div key={itemIdx} className={`flex items-center gap-1 px-2 py-1 rounded text-sm ${
                                                        darkMode ? 'bg-gray-600 text-gray-200' : 'bg-white text-gray-700'
                                                    }`}>
                                                        <button
                                                            onClick={() => editItem(catIdx, itemIdx)}
                                                            className="hover:underline cursor-pointer break-all"
                                                            title="Clique para editar"
                                                        >
                                                            {item}
                                                        </button>
                                                        <button
                                                            onClick={() => removeItem(catIdx, itemIdx)}
                                                            className={`text-red-500 hover:text-red-700 flex-shrink-0 ${
                                                                category.items.length <= 2 ? 'opacity-50 cursor-not-allowed' : ''
                                                            }`}
                                                            disabled={category.items.length <= 2}
                                                            title="Remover item"
                                                        >
                                                            <Icons.X />
                                                        </button>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* Logic Grids */}
                        <div className={`p-4 md:p-6 rounded-lg ${darkMode ? 'bg-gray-800' : 'bg-white'} shadow-lg`}>
                            <div className={`mb-4 text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'} text-center`}>
                                Clique nas c√©lulas para alternar: vazio ‚Üí X ‚Üí ‚úì
                            </div>
                            
